arrange(time)
}
# foreach(i=tmp, .export='cus') %dopar% cus(i)
for(i in 5:1){
unx = paste(Sys.Date()-1, "00:00:01")
unx = as.POSIXct(unx)
data <- get_forecast_for(3.399259, 6.519250, unx)
cus(data)
}
View(now)
update = print(x)
update = function() print(x)
update = function(x) print(x)
tmp <- seq(Sys.Date()-5, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x)) %>%
update(.x)
update = function(.x) print(.x)
tmp <- seq(Sys.Date()-5, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x)) %>%
update(.x)
update = function(x) print(x)
tmp <- seq(Sys.Date()-1, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x)) %>%
update(x)
update = function() print(x)
update = function() print(x)
tmp <- seq(Sys.Date()-1, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x)) %>%
update()
update = function(v) print(x)
tmp <- seq(Sys.Date()-1, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x)) %>%
map_df("hourly") %>% update(time)
create.f <- function(x) {
return(function() {
x <<- x + 1
print(x)
})
}
f <- create.f(100)
for (i in 1:5) f()
tmp <- seq(Sys.Date()-5, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
length(tmp)
i <- length(tmp + 1)
fun0 <- function(now){
return(function() {
now[["hourly"]] %>%
anti_join(tmp[[i]][["hourly"]], by = "time") %>%
bind_rows(tmp[[i]][["hourly"]]) %>%
arrange(time)
now[["daily"]] %>%
anti_join(tmp[[i]][["daily"]], by = "time") %>%
bind_rows(tmp[[i]][["daily"]]) %>%
arrange(time)
now[["currently"]] %>%
anti_join(tmp[[i]][["currently"]], by = "time") %>%
bind_rows(tmp[[i]][["currently"]]) %>%
arrange(time)
i <<- i - 1
now <<- now
# print(x)
})
}
# foreach(i=tmp, .export='cus') %dopar% cus(i)
# for(i in 5:1){
#   unx = paste(Sys.Date()-1, "00:00:01")
#   unx = as.POSIXct(unx)
#   data <- get_forecast_for(3.399259, 6.519250, unx)
#   cus(data)
# }
fun1 <- fun0(now)
for (i in 1:length(tmp)) fun1()
now <- get_current_forecast(3.399259, 6.519250)
fun1 <- fun0(now)
for (i in 1:length(tmp)) fun1()
View(now)
i <- length(tmp + 1)
fun0 <- function(now){
return(function() {
now[["hourly"]] %>%
anti_join(tmp[[i]][["hourly"]], by = "time") %>%
bind_rows(tmp[[i]][["hourly"]]) %>%
arrange(time)
now[["daily"]] %>%
anti_join(tmp[[i]][["daily"]], by = "time") %>%
bind_rows(tmp[[i]][["daily"]]) %>%
arrange(time)
now[["currently"]] %>%
anti_join(tmp[[i]][["currently"]], by = "time") %>%
bind_rows(tmp[[i]][["currently"]]) %>%
arrange(time)
i <<- i - 1
now <<- now
# print(x)
})
}
foreach(i=tmp, .export='fun0', .combine) %dopar% fun0(i)
View(tmp)
View(tmp[[1]][["hourly"]])
View(tmp)
View(tmp)
for (i in tmp){
View(i)
}
View(i[["hourly"]])
View(i[["hourly"]])
View(i[["hourly"]])
for (i in 1:length(tmp)){
View(tmp[[i]])
}
View(tmp[[i]][["hourly"]])
View(tmp[[i]][["hourly"]])
View(tmp[[i]][["hourly"]])
View(tmp[[i]][["hourly"]])
View(tmp[[i]][["hourly"]])
now <- get_current_forecast(3.399259, 6.519250)
for (i in 30:1){
unx = paste(Sys.Date() - i, "00:00:01")
unx = as.POSIXct(unx)
print(unx)
# tmp <- get_forecast_for(3.399259, 6.519250, unx)
}
for (i in 30:1){
unx = paste(Sys.Date() - i, "00:00:01")
unx = as.POSIXct(unx)
tmp <- get_forecast_for(3.399259, 6.519250, unx)
now[["hourly"]] %>%
anti_join(tmp[["hourly"]], by = "time") %>%
bind_rows(tmp[["hourly"]]) %>%
arrange(time)
now[["daily"]] %>%
anti_join(tmp[["daily"]], by = "time") %>%
bind_rows(tmp[["daily"]]) %>%
arrange(time)
now[["currently"]] %>%
anti_join(tmp[["currently"]], by = "time") %>%
bind_rows(tmp[["currently"]]) %>%
arrange(time)
}
View(tmp)
View(tmp[["hourly"]])
tmp <- seq(Sys.Date()-5, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
View(tmp)
View(tmp[[1]][["hourly"]])
View(tmp[[2]][["hourly"]])
print(i)
for (i in 30:1){
print(i)
}
for (i in tmp){
View(tmp[["hourly"]])
}
for (val in tmp){
View(val[["hourly"]])
}
library(dplyr)
for (val in tmp){
now[["hourly"]] %>%
anti_join(val[["hourly"]], by = "time") %>%
bind_rows(val[["hourly"]]) %>%
arrange(time)
}
for (val in tmp){
now[["hourly"]] %>%
anti_join(val[["hourly"]], by = "time") %>%
bind_rows(val[["hourly"]]) %>%
arrange(time)
View(now[["hourly"]])
}
for (val in tmp){
now[["hourly"]] %=%
anti_join(val[["hourly"]], by = "time") %=%
bind_rows(val[["hourly"]]) %=%
arrange(time)
View(now[["hourly"]])
}
View(now[["hourly"]])
library(magrittr)
iris %>% head()
ID = c(1,2,3,4)
x = c(45,34,23,56)
y = c(104,87,99,67)
df1 = data.frame(ID, x, y)
ID = c(3,5)
x = c(10,21)
df2 = data.frame(ID, x)
df1 %>%
anti_join(df2, by = "ID") #%>%
anti_join(df1, df2, by = "ID")
anti_join(df1, df2, by = "ID") %>% bind_rows(df2)
anti_join(df1, df2, by = "ID") %>% bind_rows(df2) %>% arrange(ID)
for (val in tmp){
df1 = now[["hourly"]]
df2 = val[["hourly"]]
now[["hourly"]] <<- anti_join(df1, df2, by = "time") %>% bind_rows(df2) %>% arrange(time)
}
for (val in tmp){
df1 = now[["hourly"]]
df2 = val[["hourly"]]
df3 = anti_join(df1, df2, by = "time") %>% bind_rows(df2) %>% arrange(time)
now[["hourly"]] <<- df3
}
View(now)
for (val in tmp){
df1 = now[["hourly"]]
df2 = val[["hourly"]]
df3 = anti_join(df1, df2, by = "time") %>% bind_rows(df2) %>% arrange(time)
View(df3)
# now[["hourly"]] <<- df3
}
for (val in tmp){
df1 = now[["hourly"]]
df2 = val[["hourly"]]
# df3 = anti_join(df1, df2, by = "time") %>% bind_rows(df2) %>% arrange(time)
View(df2)
# now[["hourly"]] <<- df3
}
for (val in 1:length(tmp)){
df1 = now[["hourly"]]
df2 = tmp[[val]][["hourly"]]
# df3 = anti_join(df1, df2, by = "time") %>% bind_rows(df2) %>% arrange(time)
View(df2)
# now[["hourly"]] <<- df3
}
tmp %>% print()
tmp %>% print("hourly")
tmp %>% map_df("hourly")
tmp %>% map_df("hourly") %>% View()
for(val in tmp %>% map_df("hourly")){
View(val)
}
tmp %>% map_df("hourly")
tmp <- seq(Sys.Date()-10, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
tmp %>% map_df("hourly")
tmp %>% map_df("daily")
View(tmp)
df2 = tmp %>% map_df("daily")
View(tmp)
df2
df1 = tmp %>% map_df("hourly")
df2 = tmp %>% map_df("daily")
df3 = tmp %>% map_df("currently")
df3
View(df3)
View(df1)
data.frame(hourly, daily, currently)
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
data.frame(hourly, daily, currently)
data = data.frame(hourly, daily, currently)
View(data)
View(data)
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
data = list(hourly, daily, currently)
View(data)
View(now)
data = list(hourly = hourly, daily = daily, currently = currently)
View(data)
data = list("hourly" = hourly, "daily" = daily, "currently" = currently)
View(data)
View(data)
tmp <- seq(Sys.Date()-20, Sys.Date()-10, "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
pre = list("hourly" = hourly, "daily" = daily, "currently" = currently)
View(pre)
View(pre[["hourly"]])
data[["hourly"]] %>%
anti_join(pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>%
arrange(time)
data[["daily"]] %>%
anti_join(pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>%
arrange(time)
data[["currently"]] %>%
anti_join(pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>%
arrange(time)
View(data)
tmp0 <- seq(Sys.Date()-10, Sys.Date()-0, "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
ly = tmp0 %>% map_df("hourly")
daily = tmp0 %>% map_df("daily")
currently = tmp0 %>% map_df("currently")
data = list("hourly" = hourly, "daily" = daily, "currently" = currently)
View(data[["daily"]])
View(pre[["daily"]])
anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df = anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
View(df)
data[["daily"]] = df
View(data[["daily"]])
unx = paste(Sys.Date(), "00:00:01")
unx0 = paste(Sys.Date(), "00:08:01")
unx - unx0
unx = as.POSIXct(unx)
unx0 = as.POSIXct(unx0)
unx - unx0
unx0 = paste(Sys.Date()-1, "00:08:01")
unx0 = as.POSIXct(unx0)
unx - unx0
unx0 = paste(Sys.Date()-5, "00:08:01")
unx0 = as.POSIXct(unx0)
unx - unx0
df1 = anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 = anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["hourly"]] = df1
data[["currently"]] = df2
saveRDS(data, "data/uweather.RData")
runApp()
unx = paste(Sys.Date(), "00:00:01")
unx = as.POSIXct(unx)
unx0 = paste(Sys.Date()-32, "00:00:01")
unx0 = as.POSIXct(unx0)
unx0 - unx
Time <- factor(unx)
a <- ymd_hms(as.character(Time))
Time0 <- factor(unx0)
a0 <- ymd_hms(as.character(Time0))
a0-aa
a0-a
day(a)
day(a0)
day(a0) - day(a)
as.numeric(unx)
unx <- as.numeric(unx)
unx0 <- as.numeric(unx0)
unx0 - unx
(unx0 - unx)/86400
tail(data$daily, 1)$time
unx = as.POSIXct(Sys.Date())
Time <- factor(unx)
a <- ymd_hms(as.character(Time))
# get hours
hour(a)
unx
Time <- factor(unx)
unx = as.POSIXct(Sys.time())
unx
Sys.time() - 32
as.numeric(Sys.time()) - 32
Time <- factor(unx)
a <- ymd_hms(as.character(Time))
# get hours
hour(a)
tmp <- seq(Sys.Date()-200, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
pre = list("hourly" = hourly, "daily" = daily, "currently" = currently)
# data = list("hourly" = hourly, "daily" = daily, "currently" = currently)
df0 = anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 = anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 = anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] = df0
data[["hourly"]] = df1
data[["currently"]] = df2
saveRDS(data, "data/uweather.RData")
View(data)
View(data[["daily"]])
# saveRDS(data, "uweather.RData")
# saveRDS(merge, "uweather.RData")
data <- readRDS("uweather.RData")
# saveRDS(data, "uweather.RData")
# saveRDS(merge, "uweather.RData")
data <- readRDS("data/uweather.RData")
View(data)
View(data[["daily"]])
View(data[["hourly"]])
tmp <- seq(Sys.Date()-60, Sys.Date()-30, "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
pre = list("hourly" = hourly, "daily" = daily, "currently" = currently)
# data = list("hourly" = hourly, "daily" = daily, "currently" = currently)
df0 = anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 = anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 = anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] = df0
data[["hourly"]] = df1
data[["currently"]] = df2
saveRDS(data, "data/uweather.RData")
View(data)
View(data[["daily"]])
View(data[["currently"]])
View(data[["currently"]])
tmp <- seq(Sys.Date()-100, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
pre = list("hourly" = hourly, "daily" = daily, "currently" = currently)
# data = list("hourly" = hourly, "daily" = daily, "currently" = currently)
df0 = anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 = anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 = anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] = df0
data[["hourly"]] = df1
data[["currently"]] = df2
saveRDS(data, "data/uweather.RData")
View(data)
View(data[["currently"]])
View(data[["daily"]])
runApp()
# saveRDS(data, "uweather.RData")
# saveRDS(merge, "uweather.RData")
data <- readRDS("data/uweather.RData")
View(data)
View(data[["daily"]])
30*24
View(tmp)
tmp <- seq(Sys.Date()- 60, Sys.Date() - 30, "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
hourly = tmp %>% map_df("hourly")
daily = tmp %>% map_df("daily")
currently = tmp %>% map_df("currently")
pre = list("hourly" = hourly, "daily" = daily, "currently" = currently)
df0 = anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 = anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 = anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] = df0
data[["hourly"]] = df1
View(data)
View(data[["daily"]])
tmp <- seq(Sys.Date()- 60, Sys.Date() - 30, "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hourly <- tmp %>% map_df("hourly")
daily <- tmp %>% map_df("daily")
currently <- tmp %>% map_df("currently")
pre <- list("hourly" = hourly, "daily" = daily, "currently" = currently)
# data <- list("hourly" <- hourly, "daily" <- daily, "currently" <- currently)
df0 <- anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 <- anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 <- anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] <- df0
data[["hourly"]] <- df1
data[["currently"]] <- df2
daily
tmp <- seq(Sys.Date()- 100, Sys.Date(), "1 day") %>%
map(~get_forecast_for(3.399259, 6.519250, .x))
hrly <- tmp %>% map_df("hourly")
dly <- tmp %>% map_df("daily")
crntly <- tmp %>% map_df("currently")
pre <- list("hourly" = hrly, "daily" = dly, "currently" = crntly)
df0 <- anti_join(data[["daily"]], pre[["daily"]], by = "time") %>%
bind_rows(pre[["daily"]]) %>% arrange(time)
df1 <- anti_join(data[["hourly"]], pre[["hourly"]], by = "time") %>%
bind_rows(pre[["hourly"]]) %>% arrange(time)
df2 <- anti_join(data[["currently"]], pre[["currently"]], by = "time") %>%
bind_rows(pre[["currently"]]) %>% arrange(time)
data[["daily"]] <- df0
data[["hourly"]] <- df1
data[["currently"]] <- df2
View(data)
View(data[["daily"]])
View(data[["currently"]])
View(data[["hourly"]])
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.packages("bindrcpp")
install.packages("bindrcpp")
install.packages("ROandaR")
install.packages("PairTrading")
install.packages(c("pair", "Trading"))
install.packages("roxygen2")
install.packages(c("jsonlite", "httr"))
